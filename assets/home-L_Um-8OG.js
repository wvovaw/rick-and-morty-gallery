import{d as m,o as c,c as v,w as f,r as I,a as D,b as d,e as u,f as h,u as _,g as n,t as g,F as w,h as U,i as C,p as N,j as R,k as T,n as A,l as E,m as B,q as L,s as q,S as H}from"./index-BQqFJ0FU.js";const j=m({__name:"button",props:{as:{default:"button"}},setup(s){return(t,a)=>(c(),v(D(t.as),null,{default:f(()=>[I(t.$slots,"default",{},void 0,!0)]),_:3}))}}),p=(s,t)=>{const a=s.__vccOpts||s;for(const[e,o]of t)a[e]=o;return a},k=p(j,[["__scopeId","data-v-4bfcee97"]]),x=["placeholder","disabled","value"],K=m({__name:"input",props:{modelValue:{},placeholder:{},disabled:{type:Boolean}},emits:["update:modelValue"],setup(s){return(t,a)=>(c(),d("input",{type:"text",placeholder:t.placeholder,disabled:t.disabled,value:t.modelValue,onInput:a[0]||(a[0]=e=>t.$emit("update:modelValue",e.target.value))},null,40,x))}}),M=p(K,[["__scopeId","data-v-db75e3e8"]]),W={class:"pagination"},z={class:"pagination__info"},G={"data-test-id":"pagination-current"},J={"data-test-id":"pagination-total"},Q=m({__name:"pagination",props:{currentPage:{},totalPages:{}},emits:["update:currentPage"],setup(s,{emit:t}){const a=s,e=t;function o(){a.currentPage>1&&e("update:currentPage",a.currentPage-1)}function l(){a.currentPage<a.totalPages&&e("update:currentPage",a.currentPage+1)}return(i,$)=>(c(),d("div",W,[u(_(k),{class:"pagination__button",disabled:i.currentPage===1,"data-test-id":"pagination-prev",onClick:o},{default:f(()=>[h(" < ")]),_:1},8,["disabled"]),n("span",z,[h(" Page "),n("span",G,g(i.currentPage),1),h(" of "),n("span",J,g(i.totalPages),1)]),u(_(k),{class:"pagination__button",disabled:i.currentPage===i.totalPages,"data-test-id":"pagination-next",onClick:l},{default:f(()=>[h(" > ")]),_:1},8,["disabled"])]))}}),X=p(Q,[["__scopeId","data-v-d0f4d8ea"]]),Y={},Z={class:"loader"};function ee(s,t){return c(),d("span",Z)}const te=p(Y,[["render",ee],["__scopeId","data-v-ce5ef632"]]),ae=["value"],se=["value","disabled"],ne=m({__name:"select",props:{modelValue:{},options:{}},emits:["update:modelValue"],setup(s,{emit:t}){const a=t;function e(o){a("update:modelValue",o.target.value)}return(o,l)=>(c(),d("select",{value:o.modelValue,onChange:e},[(c(!0),d(w,null,U(o.options,i=>(c(),d("option",{key:i.key,value:i.value,disabled:i.disabled},g(i.label),9,se))),128))],40,ae))}}),oe=p(ne,[["__scopeId","data-v-aa6827a2"]]),O=s=>(N("data-v-b6a0b7b7"),s=s(),R(),s),ce={class:"sticky-container"},ie={class:"filters"},re={class:"filters__control"},de=O(()=>n("label",{for:"chars-gal-filters-name-input"},"Character name",-1)),le={class:"filters__control"},ue=O(()=>n("label",{for:"chars-gal-filters-status-input"},"Status",-1)),_e={class:"filters__buttons"},pe=m({__name:"filters",props:{initialState:{default:()=>({name:void 0,status:void 0})}},emits:["updateFilters"],setup(s,{emit:t}){const a=s,e=t,o=[{key:"1",label:"Unknown",value:"unknown"},{key:"2",label:"Alive",value:"alive"},{key:"3",label:"Dead",value:"dead"}],l=C({name:a.initialState.name,status:a.initialState.status});function i(){e("updateFilters",{...l})}function $(){l.name=a.initialState.name,l.status=a.initialState.status,e("updateFilters",{...l})}return(y,r)=>(c(),d("div",ce,[n("div",ie,[n("div",re,[de,u(_(M),{id:"chars-gal-filters-name-input",modelValue:l.name,"onUpdate:modelValue":r[0]||(r[0]=P=>l.name=P),placeholder:"Rick","data-test-id":"name-input"},null,8,["modelValue"])]),n("div",le,[ue,u(_(oe),{id:"chars-gal-filters-status-input",modelValue:l.status,"onUpdate:modelValue":r[1]||(r[1]=P=>l.status=P),options:o,"data-test-id":"status-select"},null,8,["modelValue"])]),n("div",_e,[u(_(k),{"data-test-id":"submit",onClick:i},{default:f(()=>[h(" Submit ")]),_:1}),u(_(k),{"data-test-id":"reset",onClick:$},{default:f(()=>[h(" Reset ")]),_:1})])])]))}}),me=p(pe,[["__scopeId","data-v-b6a0b7b7"]]),he={},fe={class:"empty-state"},ge={class:"empty-state__text"};function ve(s,t){return c(),d("div",fe,[n("div",ge,[I(s.$slots,"default",{},void 0)])])}const be=p(he,[["render",ve],["__scopeId","data-v-c7e90b4e"]]),$e={class:"status"},Pe={class:"status__label"},ke=m({__name:"status",props:{status:{}},setup(s){const t=s,a=T(()=>t.status?t.status.toLowerCase():"unknown");return(e,o)=>(c(),d("div",$e,[n("div",{class:A(["status__indicator",{"status__indicator--alive":a.value==="alive","status__indicator--dead":a.value==="dead","status__indicator--unknown":a.value==="unknown"}])},null,2),n("span",Pe,g(a.value),1)]))}}),we=p(ke,[["__scopeId","data-v-ef4da1a3"]]),ye={CHARACTERS_NOT_FOUND:"Characters not found",EPISODE_NOT_FOUND:"Requested episode not found",UNKNOWN_ERROR:"Unknown error occured"};class b extends Error{constructor(t="UNKNOWN_ERROR"){super(ye[t]),this.code=t,this.name="ApiError"}}async function V(s){const t=await fetch(`${s}`);if(!t.ok)throw new Error(`Request error: ${t.status}`);return t.json()}async function Se({page:s=1,filters:{name:t,status:a}}){try{let e=`/character/?page=${s}`;return t&&(t==null?void 0:t.length)>0&&(e=e.concat(`&name=${t}`)),a&&(a==null?void 0:a.length)>0&&(e=e.concat(`&status=${a}`)),await V(e)}catch(e){if(e instanceof Error){if(e.message.includes("404"))throw new b("CHARACTERS_NOT_FOUND")}else throw new b}}async function Ce(s){try{return await V(`/episode/${s}`)}catch(t){if(t instanceof Error){if(t.message.includes("404"))throw new b("EPISODE_NOT_FOUND")}else throw new b}}const S=new Map;async function Ie(s){if(S.has(s))return S.get(s);{const a=new URL(s).pathname.substring(13),e=await Ce(Number(a));return e&&S.set(s,e),e}}const F=s=>(N("data-v-24966b07"),s=s(),R(),s),Ue={class:"card"},Ne={class:"card__aside"},Re=["src","alt"],Ee={class:"card__body"},Oe={class:"card__section"},Ve={class:"name","data-test-id":"name"},Fe={class:"card__section"},De=F(()=>n("span",{class:"label"},"Last location:",-1)),Te={class:"location","data-test-id":"location"},Ae={class:"card__section"},Be=F(()=>n("span",{class:"label"},"First seen in:",-1)),Le={class:"episode","data-test-id":"episode"},qe={key:1,class:"skeleton episode-skeleton","data-test-id":"episode-skeleton"},He=m({__name:"character-card",props:{image:{},name:{},status:{},location:{},episode:{}},setup(s){const t=s,a=E();return B(async()=>{const e=await Ie(t.episode);e?a.value=e.name:a.value="Unknown"}),(e,o)=>(c(),d("div",Ue,[n("div",Ne,[n("img",{src:e.image.src,alt:e.image.alt,"data-test-id":"image"},null,8,Re)]),n("div",Ee,[n("div",Oe,[n("div",Ve,g(e.name),1),u(we,{status:e.status,"data-test-id":"status"},null,8,["status"])]),n("div",Fe,[De,n("span",Te,g(e.location),1)]),n("div",Ae,[Be,n("span",Le,[a.value?(c(),d(w,{key:0},[h(g(a.value),1)],64)):(c(),d("div",qe))])])])]))}}),je=p(He,[["__scopeId","data-v-24966b07"]]),xe={class:"container"},Ke={class:"grid"},Me=m({__name:"characters-grid",props:{characters:{}},setup(s){return(t,a)=>(c(),d("div",xe,[n("div",Ke,[(c(!0),d(w,null,U(t.characters,e=>(c(),v(_(je),{key:e.id,name:e.name,image:{alt:e.name,src:e.image},location:e.location.name,status:e.status,episode:e.episode[0],"data-test-id":"character-card"},null,8,["name","image","location","status","episode"]))),128))])]))}}),We=p(Me,[["__scopeId","data-v-c140369d"]]),ze=m({__name:"characters-gallery",async setup(s){let t,a;const e=E([]),o=C({currentPage:1,totalPages:1});function l(r){o.currentPage=r}const i=C({name:void 0,status:void 0});function $(r){i.name=r.name,i.status=r.status,o.currentPage=1}async function y(){try{const r=await Se({page:o.currentPage,filters:{name:i.name,status:i.status}});r&&(e.value=r.results,o.totalPages=r.info.pages)}catch(r){if(r instanceof b)r.code==="CHARACTERS_NOT_FOUND"&&(e.value=[],o.totalPages=1,o.currentPage=1);else throw r}}return L([i,()=>o.currentPage],()=>{y()}),[t,a]=q(()=>y()),await t,a(),(r,P)=>(c(),d(w,null,[e.value.length?(c(),v(_(We),{key:0,characters:e.value},null,8,["characters"])):(c(),v(be,{key:1},{default:f(()=>[h(" No characters found ")]),_:1})),u(_(X),{"current-page":o.currentPage,"total-pages":o.totalPages,"onUpdate:currentPage":l},null,8,["current-page","total-pages"]),u(me,{onUpdateFilters:$})],64))}}),Ge={class:"page"},Je=m({__name:"home",setup(s){return(t,a)=>(c(),d("main",Ge,[(c(),v(H,null,{fallback:f(()=>[u(_(te),{class:"loading"})]),default:f(()=>[u(_(ze))]),_:1}))]))}}),Xe=p(Je,[["__scopeId","data-v-ac610df6"]]);export{Xe as default};
